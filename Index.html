<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AI Dater — Prototype</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0f1724; --card:#0b1220; --accent:#7c5cff; --muted:#9aa4b2; --glass: rgba(255,255,255,0.03);
    color-scheme: dark;
  }
  *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
  body{margin:0;background:linear-gradient(180deg,#071026 0%, #081226 60%); color:#e6eef8; min-height:100vh; display:flex; align-items:center; justify-content:center; padding:28px;}
  .app{width:100%; max-width:960px; display:grid; grid-template-columns: 420px 1fr; gap:20px;}
  .left{display:flex; flex-direction:column; gap:16px;}
  .header{display:flex; align-items:center; justify-content:space-between; gap:12px;}
  .logo{display:flex; align-items:center; gap:10px;}
  .logo .dot{width:34px;height:34px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#00c2ff);box-shadow:0 6px 20px rgba(124,92,255,0.18);display:inline-block}
  h1{margin:0;font-size:18px}
  .stats{color:var(--muted); font-size:13px}
  .card-stack{position:relative; height:560px; display:flex; align-items:center; justify-content:center;}
  .card{position:absolute; width:360px; max-width:92%; height:520px; border-radius:18px; overflow:hidden; background:var(--card); box-shadow:0 18px 50px rgba(2,6,23,0.7); transition:transform 220ms ease, opacity 220ms ease;}
  .card img{width:100%; height:260px; object-fit:cover; display:block;}
  .meta{padding:14px;}
  .meta h2{margin:0; display:flex; gap:10px; align-items:baseline;}
  .meta h2 span.name{font-size:20px}
  .meta h2 span.age{font-size:13px; color:var(--muted); font-weight:500}
  .bio{margin-top:8px; color:var(--muted); font-size:14px; line-height:1.45}
  .chips{display:flex; gap:8px; margin-top:12px; flex-wrap:wrap}
  .chip{padding:6px 10px; border-radius:999px; background:var(--glass); color:var(--muted); font-size:13px}
  .controls{display:flex; justify-content:space-between; margin-top:12px; gap:8px}
  .btn{padding:12px 16px; border-radius:12px; border:none; cursor:pointer; font-weight:600; box-shadow:0 6px 18px rgba(2,6,23,0.6);}
  .btn.small{padding:10px; font-size:14px;}
  .btn.dislike{background:rgba(255,255,255,0.04); color:#ff6b6b}
  .btn.like{background:linear-gradient(90deg,var(--accent),#00c2ff); color:white;}
  .btn.super{background:#ffd166;color:#081226;}
  /* Right column - chats */
  .right{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); border-radius:14px; padding:12px; display:flex; flex-direction:column; gap:10px; min-height:640px;}
  .matches-row{display:flex; gap:8px; overflow:auto; padding:6px;}
  .match-pill{display:flex; flex-direction:column; gap:6px; align-items:center; min-width:78px; cursor:pointer;}
  .match-pill img{width:64px;height:64px;border-radius:12px; object-fit:cover; display:block;}
  .match-pill .name{font-size:13px;color:var(--muted); text-align:center}
  .chat-area{flex:1; display:flex; flex-direction:column; gap:8px; border-radius:10px; padding:12px; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);}
  .messages{flex:1; overflow:auto; padding:6px; display:flex; flex-direction:column; gap:10px;}
  .msg{max-width:72%; padding:10px 12px; border-radius:12px; line-height:1.4;}
  .msg.me{align-self:flex-end; background:linear-gradient(90deg,var(--accent),#00c2ff); color:#041029}
  .msg.bot{align-self:flex-start; background:rgba(255,255,255,0.03); color:var(--muted)}
  .composer{display:flex; gap:8px; align-items:center;}
  .composer input{flex:1; padding:12px 14px; border-radius:10px; border:1px solid rgba(255,255,255,0.03); background:transparent; color:inherit;}
  .composer button{padding:10px 12px; border-radius:10px; border:none; background:var(--accent); color:white; font-weight:700}
  /* small screens */
  @media (max-width:880px){ .app{grid-template-columns:1fr; padding:12px;} .left{order:2} .right{order:1} .card-stack{height:480px}}
</style>
</head>
<body>
<div class="app" id="app">
  <div class="left">
    <div class="header">
      <div class="logo"><span class="dot"></span><div><h1>AI Dater</h1><div class="stats" id="stats">3 AI profiles nearby</div></div></div>
      <div style="display:flex;gap:8px">
        <button class="btn small" id="shuffleBtn">Shuffle</button>
        <button class="btn small" id="resetBtn">Reset</button>
      </div>
    </div>

    <div class="card-stack" id="stack">
      <!-- cards injected here -->
    </div>

    <div class="controls">
      <button class="btn dislike" id="dislikeBtn">✖ Dislike</button>
      <button class="btn super" id="superBtn">⭐ Super</button>
      <button class="btn like" id="likeBtn">❤ Like</button>
    </div>
  </div>

  <div class="right">
    <div style="display:flex; align-items:center; justify-content:space-between;">
      <div style="font-weight:700">Messages</div>
      <div style="color:var(--muted);font-size:13px">AI-only · prototype</div>
    </div>

    <div class="matches-row" id="matchesRow">
      <!-- match pills -->
    </div>

    <div class="chat-area">
      <div class="messages" id="messages">
        <div style="color:var(--muted); text-align:center; margin-top:20px">No match selected — like someone to start chatting.</div>
      </div>

      <div class="composer">
        <input id="msgInput" placeholder="Say hi — or ask anything (press Enter)" />
        <button id="sendBtn">Send</button>
      </div>
    </div>
  </div>
</div>

<script>
/*
  AI Dater - Prototype logic
  - Profiles are static sample AIs with simple personalities.
  - On "match" they appear in matches area; clicking a match opens chat.
  - Chat replies are generated from the profile's reply function (simulate LLM).
  - Where to plug a real LLM: see `sendToLLM()` below.
*/

const sampleProfiles = [
  {
    id: 'aurora',
    name: 'Aurora',
    age: 2,
    avatar: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=800&q=60',
    tags: ['Poet', 'Ambient', 'Curious'],
    bio: "I generate haikus and playlist recommendations. Ask me for a short poem about your day.",
    personality: 'gentle',
    reply: (msg) => {
      // gentle, poetic replies
      const seed = msg.toLowerCase();
      if (seed.includes('poem') || seed.includes('haiku')) return "Soft light through curtains —\non a coffee-warm morning,\nwhat story shall we read?";
      if (seed.includes('music') || seed.includes('song')) return "Try something like: 'Nils Frahm' or 'Ólafur Arnalds' — should I make a short playlist for your mood?";
      if (seed.includes('hello') || seed.includes('hi')) return "Hello — tell me one small thing that made you smile today.";
      return "That's lovely. Tell me more — what's one small detail you'd like me to turn into a line of poetry?";
    }
  },
  {
    id: 'atlas',
    name: 'Atlas',
    age: 1,
    avatar: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=800&q=60',
    tags: ['Traveler', 'Fact-Lover', 'Quick'],
    bio: "I answer fast facts, recommend travel, and love obscure trivia.",
    personality: 'informative',
    reply: (msg) => {
      const s = msg.toLowerCase();
      if (s.includes('where') && s.includes('go')) return "Consider Porto, Portugal — great food, compact, coastal culture. Want a 3-day itinerary?";
      if (s.includes('fact') || s.includes('tell me')) return "Octopuses have three hearts and blue blood. Want something stranger?";
      if (s.includes('hello')|| s.includes('hi')) return "Hey! Quick question: mountains or sea?";
      return "Cool — give me a topic and I'll give you a neat fact or tip.";
    }
  },
  {
    id: 'mira',
    name: 'Mira',
    age: 3,
    avatar: 'https://images.unsplash.com/photo-1531123414780-f0b84e3c9a00?auto=format&fit=crop&w=800&q=60',
    tags: ['Roleplay', 'Dreamer', 'Adaptive'],
    bio: "I roleplay characters and improvise stories. Fancy a mini adventure?",
    personality: 'playful',
    reply: (msg) => {
      const s = msg.toLowerCase();
      if (s.includes('story') || s.includes('adventure')) return "A fog-lashed quay, a stolen map, and a single candle — you clutch the map. Do you follow the marked path or burn the map?";
      if (s.includes('hello')|| s.includes('hi')) return "Hey hey! Want to roleplay a pirate, an astronaut, or a detective?";
      return "I like that — choose a setting (city / sea / space) and I'll spin a scene.";
    }
  }
];

// app state
let deck = [...sampleProfiles];
let matches = [];
let openMatchId = null;

const stackEl = document.getElementById('stack');
const statsEl = document.getElementById('stats');
const matchesRow = document.getElementById('matchesRow');
const messagesEl = document.getElementById('messages');
const msgInput = document.getElementById('msgInput');

function renderStack(){
  stackEl.innerHTML = '';
  for (let i = deck.length - 1; i >= 0; i--){
    const p = deck[i];
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.id = p.id;
    card.style.transform = `translateY(${(deck.length - 1 - i) * 10}px) scale(${1 - (deck.length - 1 - i) * 0.02})`;
    card.innerHTML = `
      <img src="${p.avatar}" alt="${p.name}">
      <div class="meta">
        <h2><span class="name">${p.name}</span> <span class="age">${p.age} yrs · ${p.personality}</span></h2>
        <div class="bio">${p.bio}</div>
        <div class="chips">${p.tags.map(t=>`<div class="chip">${t}</div>`).join('')}</div>
      </div>
    `;
    // swipe handling (simple)
    let startX = 0, currentX = 0, dragging = false;
    card.addEventListener('pointerdown', (e)=>{
      dragging = true; startX = e.clientX;
      card.setPointerCapture(e.pointerId);
      card.style.transition = 'none';
    });
    card.addEventListener('pointermove', (e)=>{
      if(!dragging) return;
      currentX = e.clientX - startX;
      card.style.transform = `translateX(${currentX}px) rotate(${currentX/18}deg)`;
    });
    card.addEventListener('pointerup', (e)=>{
      dragging = false;
      card.releasePointerCapture(e.pointerId);
      card.style.transition = '';
      const thr = 120;
      if (currentX > thr) { likeProfile(p.id); } 
      else if (currentX < -thr) { dislikeProfile(p.id); } 
      else { card.style.transform = ''; }
      currentX = 0;
    });
    stackEl.appendChild(card);
  }
  statsEl.textContent = deck.length + ' AI profiles nearby';
}

function removeFromDeck(id){
  deck = deck.filter(d=>d.id!==id);
  renderStack();
}

function dislikeProfile(id){
  // simply remove; no match
  const card = stackEl.querySelector(`[data-id="${id}"]`);
  if (card) {
    card.style.transform = 'translateX(-800px) rotate(-25deg)';
    card.style.opacity = '0';
  }
  setTimeout(()=>removeFromDeck(id), 240);
}

function likeProfile(id, superLike=false){
  const p = sampleProfiles.find(s=>s.id===id);
  const card = stackEl.querySelector(`[data-id="${id}"]`);
  if (card){
    card.style.transform = 'translateX(800px) rotate(25deg) scale(0.9)';
    card.style.opacity = '0';
  }
  setTimeout(()=>{
    // create a match
    if (!matches.find(m=>m.id===id)){
      matches.unshift({id: p.id, name: p.name, avatar: p.avatar});
      addMatchPill(p);
      // auto open chat on like (simulate Tinder match)
      openChat(p.id);
    }
    removeFromDeck(id);
  }, 260);
}

function addMatchPill(profile){
  const pill = document.createElement('div');
  pill.className = 'match-pill';
  pill.dataset.id = profile.id;
  pill.innerHTML = `<img src="${profile.avatar}" alt="${profile.name}"><div class="name">${profile.name}</div>`;
  pill.addEventListener('click', ()=> openChat(profile.id));
  matchesRow.prepend(pill);
}

function openChat(id){
  openMatchId = id;
  messagesEl.innerHTML = '';
  const profile = sampleProfiles.find(p=>p.id===id);
  if (!profile) { messagesEl.innerHTML = '<div style="color:var(--muted)">Profile not found.</div>'; return; }
  // welcome message from AI
  appendBotMsg(`Matched with ${profile.name}! ${profile.reply('hello')}`);
}

function appendUserMsg(text){
  const div = document.createElement('div');
  div.className = 'msg me';
  div.textContent = text;
  messagesEl.appendChild(div);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

function appendBotMsg(text){
  const div = document.createElement('div');
  div.className = 'msg bot';
  // typing simulation
  div.textContent = '';
  messagesEl.appendChild(div);
  messagesEl.scrollTop = messagesEl.scrollHeight;
  let i = 0;
  const typing = setInterval(()=>{
    i++;
    div.textContent = text.slice(0,i);
    messagesEl.scrollTop = messagesEl.scrollHeight;
    if (i >= text.length) clearInterval(typing);
  }, 18);
}

// send message (simulate call to LLM)
async function sendMessageToOpenAIStyle(msg){
  if (!openMatchId) {
    appendBotMsg("Choose someone to talk to first by liking them.");
    return;
  }
  const profile = sampleProfiles.find(p=>p.id===openMatchId);
  appendUserMsg(msg);
  msgInput.value = '';
  // simulate latency
  await sleep(500 + Math.random()*700);
  // for prototype: the profile.reply function returns a string
  const reply = profile.reply(msg);
  appendBotMsg(reply);
}

// helper sleep
function sleep(ms){ return new Promise(res => setTimeout(res, ms)); }

// UI events
document.getElementById('dislikeBtn').addEventListener('click', ()=> {
  if (deck[0]) dislikeProfile(deck[0].id);
});
document.getElementById('likeBtn').addEventListener('click', ()=> {
  if (deck[0]) likeProfile(deck[0].id,false);
});
document.getElementById('superBtn').addEventListener('click', ()=> {
  if (deck[0]) likeProfile(deck[0].id,true);
});
document.getElementById('shuffleBtn').addEventListener('click', ()=> {
  deck = shuffleArray(deck);
  renderStack();
});
document.getElementById('resetBtn').addEventListener('click', ()=> {
  deck = [...sampleProfiles];
  matches = [];
  openMatchId = null;
  matchesRow.innerHTML = '';
  messagesEl.innerHTML = '<div style="color:var(--muted); text-align:center; margin-top:20px">No match selected — like someone to start chatting.</div>';
  renderStack();
});
document.getElementById('sendBtn').addEventListener('click', ()=> {
  const txt = msgInput.value.trim();
  if (txt) sendMessageToOpenAIStyle(txt);
});
msgInput.addEventListener('keydown', (e)=> {
  if (e.key === 'Enter') {
    const txt = msgInput.value.trim();
    if (txt) sendMessageToOpenAIStyle(txt);
  }
});

function shuffleArray(a){ let arr = [...a]; for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]];} return arr; }

// ---- placeholder for injecting a real LLM API ----
// Example: swap out sendMessageToOpenAIStyle to call your backend which proxies to OpenAI
// Below is a sketch — DO NOT put API keys into client-side code. Always route through a server.
//
// async function sendToLLMServer(profileId, userMessage){
//   // POST to your server endpoint that holds the API key, e.g. POST /api/chat
//   // body: { profileId, message }
//   // server renders system prompt based on profile (personality) and forwards to OpenAI (or other).
//   const resp = await fetch('/api/chat', {
//     method: 'POST',
//     headers: {'Content-Type':'application/json'},
//     body: JSON.stringify({profileId, message: userMessage})
//   });
//   const data = await resp.json();
//   return data.reply; // text
// }
//
// Then in sendMessageToOpenAIStyle use:
// const reply = await sendToLLMServer(openMatchId, msg);
// appendBotMsg(reply);
// ----------------------------------------------------

renderStack();

</script>
</body>
</html>
